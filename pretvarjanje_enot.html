<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pretvarjanje enot</title>
  <style>
    /* theme vars ‚Äì barve za dark vibe;  */
    :root{
      --bg:#0f172a; --panel:#111827; --muted:#1f2937; --text:#e5e7eb;
      --accent:#38bdf8; --ok:#22c55e; --bad:#ef4444; --btn:#374151; --btn-hover:#4b5563;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      /* sys fonts = hitr & clean; noben ne rabi fancy serifov tle */
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans","Helvetica Neue",Arial;
      background:linear-gradient(180deg,#0b1220,var(--bg));
      color:var(--text); line-height:1.5
    }
    header{padding:24px 16px; border-bottom:1px solid #1f2937}
    h1{margin:0 0 6px 0; font-weight:800}
    .sub{opacity:.85; font-size:14px}
    .container{max-width:1000px; margin:0 auto; padding:16px; display:grid; gap:16px}
    .panel{
      /* blur + shadow = malo ‚Äúglass‚Äù feeling, ker zakaj pa ne */
      background:rgba(17,24,39,.7); border:1px solid #1f2937; border-radius:16px; padding:16px;
      backdrop-filter:blur(6px); box-shadow:0 10px 25px rgba(0,0,0,.25)
    }
    .row{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
    select,input[type="text"]{
      background:var(--muted); color:var(--text); border:1px solid #334155; border-radius:12px; padding:10px 12px; outline:none; font-size:16px
    }
    select:focus,input:focus{border-color:var(--accent)}
    .btn{
      /* gumbi brez filozofije ‚Äì basic, solid */
      background:var(--btn); color:var(--text); border:1px solid #475569; border-radius:12px; padding:10px 14px; font-weight:600; cursor:pointer
    }
    .btn:hover{background:var(--btn-hover)}
    .grid{display:grid; grid-template-columns:1fr; gap:14px}
    .task{border:1px solid #1f2937; background:#0b1328; border-radius:14px; padding:14px}
    .task h3{margin:0 0 10px 0; font-size:16px}
    .task .result{margin-top:10px; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .ok{color:var(--ok); font-weight:700} .bad{color:var(--bad); font-weight:700} .muted{opacity:.8}
    .kpi{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .chip{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:rgba(148,163,184,.15); border:1px solid rgba(148,163,184,.35)}
    .hint,.solution{margin-top:8px; padding:10px; border-radius:10px; background:#0b1020; border:1px dashed #334155; white-space:pre-wrap}
    .note{opacity:.85; font-size:13px; margin-top:6px}
    .sr-only{position:absolute; left:-9999px}
    @media print{
      /* print mode ‚Äì pobri≈°i vse knofe in ≈°minko; ≈°paramo toner */
      header,.controls,.kpi,.task .btn,.task .hint,.task .solution{display:none!important}
      .task{page-break-inside:avoid; border:none; background:transparent; padding:8px 0}
      body{background:#fff; color:#000}
    }
    :focus-visible{outline:2px solid var(--accent); outline-offset:2px}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Pretvarjanje enot</h1>
      <div class="sub"><!-- ƒçe rabi≈° podnaslov, ga napi≈°i sem; zaenkrat chill --></div>
    </div>
  </header>
  <main class="container">
    <section class="panel controls" aria-label="Nastavitve nalog">
      <div class="row">
        <label for="cat">Koliƒçina</label>
        <select id="cat">
          <!-- ja, klasika: SI kvantitete; nobenih eksotiƒçnih -->
          <option value="masa">Masa</option>
          <option value="dolzina">Dol≈æina</option>
          <option value="povrsina">Povr≈°ina</option>
          <option value="prostornina">Prostornina</option>
          <option value="cas" selected>ƒåas</option>
        </select>
        <label for="level">Stopnja</label>
        <select id="level">
          <!-- labels = vibe check; value ostane ‚ÄúA1..C1‚Äù za logiko -->
          <option value="A1">Lahka üéÆ</option>
          <option value="A2">Srednja üõ°Ô∏è</option>
          <option value="B1">Te≈æka ‚öîÔ∏è</option>
          <option value="B2">I kick ass üî•</option>
          <option value="C1">Alien üëΩ</option>
        </select>
        <label for="smer">Smer</label>
        <select id="smer">
          <!-- smer samo za SI predpone, ƒças ma svojo foro -->
          <option value="vec-v-manj">Veƒçja ‚Üí manj≈°a predpona</option>
          <option value="manj-v-vec">Manj≈°a ‚Üí veƒçja predpona</option>
          <option value="oboje" selected>Oboje</option>
        </select>
        <button class="btn" id="make5">Ustvari 5 nalog</button>
        <button class="btn" id="printBtn">Tiskaj</button>
      </div>
      <div class="row kpi" aria-live="polite">
        <!-- quick stats ‚Äì kolk si zadel vs. skupno; ƒçisti HUD -->
        <span class="chip" id="kpiCount">0/0</span>
        <span class="chip" id="kpiPct">0%</span>
      </div>
    </section>

    <section class="panel">
      <!-- sem grejo taski; auto fill -->
      <div class="grid" id="tasks"></div>
    </section>

    <section class="note"><!-- tip & tricks po ≈æelji --></section>
  </main>

<script>
(() => {
  // prefix exponenti ‚Äì stara dobra SI lestvica; niƒç filozofije
  const PREFIX_EXP = {'G':9,'M':6,'k':3,'h':2,'da':1,'':0,'d':-1,'c':-2,'m':-3,'¬µ':-6,'n':-9};

  // baze za koliƒçine ‚Äì ‚Äúunit + dim‚Äù (dim=potenca za m¬≤/m¬≥ game)
  const BASE_UNITS = {
    masa:{unit:'g',dim:1,prefixes:['G','M','k','h','da','','d','c','m','¬µ','n']},
    dolzina:{unit:'m',dim:1,prefixes:['G','M','k','h','da','','d','c','m','¬µ','n']},
    povrsina:{unit:'m',dim:2,prefixes:['G','M','k','h','da','','d','c','m','¬µ','n']},
    prostornina:{unit:'m',dim:3,prefixes:['G','M','k','h','da','','d','c','m','¬µ','n']},
    cas:{unit:'s',dim:1,prefixes:[]} // ƒças je svoj film ‚Äì brez predpon, ker real life
  };

  // TIME gang ‚Äì vrstni red + faktorji ‚Üí vedno do sekund, ƒçist simple
  const TIME_ORDER = ['teden','dan','h','min','s','cs','ms'];
  const TIME_TO_SECONDS = { teden:604800, dan:86400, h:3600, min:60, s:1, cs:0.01, ms:0.001 };
  const ADJ_FACT = { 'teden->dan':7, 'dan->h':24, 'h->min':60, 'min->s':60, 's->cs':100, 'cs->ms':10 };

  // level parametri ‚Äì A1..C1 ostane backend; user vidi gamer labels
  const LEVELS = {
    A1:{min:1,max:50,maxDelta:2},
    A2:{min:1,max:200,maxDelta:3},
    B1:{min:0.1,max:500,maxDelta:6},
    B2:{min:0.1,max:5000,maxDelta:8},
    C1:{min:0.01,max:10000,maxDelta:10}
  };

  // scoreboard state ‚Äì niƒç posebnega
  const state={correct:0,total:0};

  // mini $ helper ‚Äì ja, chill
  const $=sel=>document.querySelector(sel);
  const tasksEl=$('#tasks'), kpiCount=$('#kpiCount'), kpiPct=$('#kpiPct');

  function updateKPI(){
    // live HUD ‚Äì kolk je aim assist zadel
    kpiCount.textContent=`${state.correct}/${state.total}`;
    const p=state.total?Math.round(100*state.correct/state.total):0;
    kpiPct.textContent=`${p}%`;
  }

  // RNG ‚Äì basic stuff
  function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
  function randFloat(a,b){return Math.random()*(b-a)+a;}

  // generiraj ≈°tevilo za mre≈æo ‚Äì vƒçasih celo, vƒçasih decimalkice (1‚Äì3)
  function gridNumber(level){
    const c=LEVELS[level];
    if(Math.random()<.5){return {value:randInt(Math.ceil(c.min),Math.floor(c.max))};}
    let v=randFloat(c.min,c.max);
    v=+v.toFixed(randInt(1,3));
    return {value:v};
  }

  // parsing user vnosa ‚Äì vejice, pike, praznine ‚Üí normalize or go home
  function parseNum(s){
    if(typeof s!=='string') return NaN;
    s=s.trim().replace(',','.').replace(/\s+/g,'');
    return Number(s);
  }

  // kolk decimalk v raw stringu ‚Äì za 0‚Äì2 policy check
  function decimalsCountRaw(str){
    const m=(str.trim().replace(',', '.').match(/\.(\d+)/));
    return m ? m[1].length : 0;
  }

  // equals with tol ‚Äì floating point gre vƒçasih malo ‚Äúpo svoje‚Äù
  function eqTol(a,b){
    const ae=Math.abs(a-b), re=ae/(Math.abs(b)||1);
    return ae<=1e-10 || re<=1e-8;
  }

  // format ‚â§2 dec ‚Äì brez nepotrebnih trailing nul
  function fmtUpTo2(x){
    const v = Math.round(x*100)/100;
    return v.toLocaleString('sl-SI', { minimumFractionDigits: 0, maximumFractionDigits: 2 });
  }

  const NF = new Intl.NumberFormat('sl-SI'); // ƒçe kdaj rabi≈° clean format

  // slovenski labeli za ‚Äúdan‚Äù & ‚Äúteden‚Äù ‚Äì da zveni legit
  function labelTimeUnit(value, unit, context) {
    // context: 'title' = unit name (singular), 'result' = po ≈°tevilu
    if (unit === 'dan') {
      if (context === 'title') return 'dan';
      const n = Math.abs(Number(value));
      if (Number.isInteger(n) && n === 1) return 'dan';
      if (Number.isInteger(n) && n === 2) return 'dneva';
      return 'dni'; // 0, 3+, decimale, negativne ‚Üí dni
    }
    if (unit === 'teden') {
      if (context === 'title') return 'teden';
      const n = Math.abs(Number(value));
      const isInt = Number.isInteger(n);
      if (!isInt) return 'tedna';    // decimale se sli≈°i najbolj ‚Äútedna‚Äù
      if (n === 1) return 'teden';
      if (n === 2) return 'tedna';
      if (n >= 3 && n <= 4) return 'tedni';
      return 'tednov';               // 0 in 5+
    }
    // ostale enote naj ostanejo kratice (h, min, s, cs, ms)
    return unit;
  }

  // SI display helper ‚Äì doda ¬≤/¬≥ ƒçe je dim 2/3; oldschool ^n fallback
  function displayUnit(prefix, unit, dim){
    const base = `${prefix}${unit}`;
    if(dim===1) return base;
    if(dim===2) return base + '¬≤';
    if(dim===3) return base + '¬≥';
    return base + '^' + dim;
  }

  // razstavi enoto: prefix vs base ‚Äì quick&dirty regex, dela
  function extractPrefix(u){ const base = u.replace(/^[GMkhda dcm¬µn]*/,'' ); return u.replace(base,''); }
  function extractBase(u){ return u.replace(/^[GMkhda dcm¬µn]*/,''); }

  // pick SI prefix par ‚Äì kontroliran kaos (maxDelta zategne te≈æavnost)
  function pickPrefixPair(prefixes, level, smer){
    const arr = prefixes.slice();
    let from,to,tries=0, maxDelta=LEVELS[level].maxDelta;
    while(tries++<200){
      from=arr[randInt(0,arr.length-1)];
      to=arr[randInt(0,arr.length-1)];
      if(from===to) continue;
      const delta = Math.abs(PREFIX_EXP[from]-PREFIX_EXP[to]);
      if(delta>0 && delta<=maxDelta){
        if(smer==='vec-v-manj' && PREFIX_EXP[from]>=PREFIX_EXP[to]) return {from,to};
        if(smer==='manj-v-vec' && PREFIX_EXP[from]<=PREFIX_EXP[to]) return {from,to};
        if(smer==='oboje') return {from,to};
      }
    }
    // ƒçe RNG preveƒç trmast ‚Äì vzemi prvi par, life goes on
    return {from:arr[0],to:arr[1]};
  }

  // pick ƒçasovni par ‚Äì random iz TIME_ORDER
  function pickTimePair(){
    const i = randInt(0, TIME_ORDER.length-1);
    let j = randInt(0, TIME_ORDER.length-1);
    if(i===j) j = (j+1) % TIME_ORDER.length; // ne pretvarjaj v isto stvar, lol
    return { from: TIME_ORDER[i], to: TIME_ORDER[j] };
  }

  // generiraj ‚Äúgiven‚Äù tako, da bo rezultat imel max 2 dec (brez roundanja)
  // ideja: target = k/100 ‚Üí garantiran limit 0‚Äì2 dec
  function chooseGivenForMaxTwoDecimals(from, to, level){
    const R = TIME_TO_SECONDS[from] / TIME_TO_SECONDS[to];
    const c = LEVELS[level];
    if (R >= 1){
      // mno≈æenje z int ‚Üí dec(given) se ohrani
      const mode = randInt(0,2); // ciljaj 0,1 ali 2 dec
      if (mode === 0){
        const minK = Math.ceil(c.min);
        const maxK = Math.max(minK, Math.floor(c.max));
        return randInt(minK, Math.min(maxK, minK+500));
      } else if (mode === 1){
        const minK = Math.ceil(c.min*10);
        const maxK = Math.max(minK, Math.floor(c.max*10));
        return randInt(minK, Math.min(maxK, minK+500)) / 10;
      } else {
        const minK = Math.ceil(c.min*100);
        const maxK = Math.max(minK, Math.floor(c.max*100));
        return randInt(minK, Math.min(maxK, minK+500)) / 100;
      }
    } else {
      // deljenje z int D: given = (k*D)/100 ‚Üí result = k/100
      const D = Math.round(1/R);
      const minK = Math.ceil(c.min*100 / D);
      const maxK = Math.max(minK, Math.floor(c.max*100 / D));
      const k = randInt(minK, Math.min(maxK, minK+500));
      return (k*D)/100;
    }
  }

  // build task ‚Äì ƒçe je ƒças, gre ƒçez svoj pipeline; drugaƒçe SI predpone
  function buildTask(idx, cat, level, smer){
    if(cat==='cas'){
      const {from,to} = pickTimePair();
      const given = chooseGivenForMaxTwoDecimals(from, to, level);
      const seconds = given * TIME_TO_SECONDS[from];
      const result = seconds / TIME_TO_SECONDS[to]; // tole pride ven toƒçno do 2 dec
      return renderTask(idx, given, from, to, 'cas', result, 1, true);
    }
    const base = BASE_UNITS[cat];
    const {from,to} = pickPrefixPair(base.prefixes, level, smer);
    const dim = base.dim, unit = base.unit;
    const given = gridNumber(level).value;
    const expDiff = (PREFIX_EXP[from]-PREFIX_EXP[to]) * dim;
    const factor = Math.pow(10, expDiff);
    const result = given * factor;
    return renderTask(idx, given, from+unit, to+unit, cat, result, dim, false);
  }

  // chain za namige ‚Äì human readable koraki (niƒç pametovanja)
  function timeChain(from, to){
    const TIME_ORDER = ['teden','dan','h','min','s','cs','ms'];
    const ADJ_FACT = { 'teden->dan':7, 'dan->h':24, 'h->min':60, 'min->s':60, 's->cs':100, 'cs->ms':10 };
    const i = TIME_ORDER.indexOf(from);
    const j = TIME_ORDER.indexOf(to);
    if(i===-1 || j===-1) return { lines:[], ops:[], direction:0 };
    const step = i<j ? +1 : -1;
    const lines = [], ops = [];
    for(let k=i; k!==j; k+=step){
      const a = TIME_ORDER[k], b = TIME_ORDER[k+step];
      const key = a+'->'+b, invKey = b+'->'+a;
      const f = (step===+1) ? ADJ_FACT[key] : ADJ_FACT[invKey];
      if(step===+1){ lines.push(`1 ${a} = ${f.toLocaleString('sl-SI')} ${b}`); ops.push({op:'*', f}); }
      else { lines.push(`1 ${b} = ${f.toLocaleString('sl-SI')} ${a}`); ops.push({op:'/', f}); }
    }
    return { lines, ops };
  }

  // render task ‚Äì sestavi UI, namig, re≈°itev, checker‚Ä¶ all-in-one
  function renderTask(idx, given, fromUnit, toUnit, cat, result, dim, isTime){
    const task = document.createElement('div');
    task.className='task'; task.dataset.locked='false';

    const h = document.createElement('h3');
    if (isTime) {
      const fromLabel = labelTimeUnit(given, fromUnit, 'result');   // npr. "3 dni", "2 tedna"
      const toLabel   = labelTimeUnit(null,  toUnit,   'title');    // ‚Äúdan‚Äù ali ‚Äúteden‚Äù
      h.innerHTML = `#${idx+1}: Pretvori <b>${fmtUpTo2(given)}</b> ${fromLabel} v ${toLabel}.`;
    } else {
      const fromP = extractPrefix(fromUnit), toP = extractPrefix(toUnit);
      const baseU = extractBase(fromUnit);
      const titleFrom = displayUnit(fromP, baseU, dim);
      const titleTo = displayUnit(toP, baseU, dim);
      h.innerHTML = `#${idx+1}: Pretvori <b>${fmtSI(given)}</b> ${titleFrom} v ${titleTo}.`;
    }
    task.appendChild(h);

    // vnos + knofi ‚Äì enter dela isto kot ‚ÄúPreveri to‚Äù
    const row = document.createElement('div'); row.className='row';
    const input = document.createElement('input'); input.type='text'; input.inputMode='decimal'; input.placeholder='vnesi rezultat (0‚Äì2 dec)'; input.className='answer';
    const checkBtn = document.createElement('button'); checkBtn.className='btn'; checkBtn.textContent='Preveri to';
    const hintBtn = document.createElement('button'); hintBtn.className='btn'; hintBtn.textContent='Poka≈æi namig';
    const solBtn = document.createElement('button'); solBtn.className='btn'; solBtn.textContent='Poka≈æi re≈°itev';
    row.appendChild(input); row.appendChild(checkBtn); row.appendChild(hintBtn); row.appendChild(solBtn);
    task.appendChild(row);

    const resultEl = document.createElement('div'); resultEl.className='result muted'; task.appendChild(resultEl);
    const hintEl = document.createElement('div'); hintEl.className='hint'; hintEl.style.display='none'; task.appendChild(hintEl);
    const solEl = document.createElement('div'); solEl.className='solution'; solEl.style.display='none';
    if (isTime) {
      const fromLabel = labelTimeUnit(given,  fromUnit, 'result');
      const toLabel   = labelTimeUnit(result, toUnit,   'result');
      solEl.innerHTML = `${fmtUpTo2(given)} ${fromLabel} = <b>${fmtUpTo2(result)}</b> ${toLabel}`;
    } else {
      solEl.innerHTML = `${fmtSI(given)} ${fromUnit} = <b>${fmtSI(result)}</b> ${toUnit}`;
    }
    task.appendChild(solEl);

    // namig ‚Äì show your work, teacher style
    if(isTime){
      const { lines, ops } = timeChain(fromUnit, toUnit);
      let expr = `${fmtUpTo2(given)} ${fromUnit}`;
      ops.forEach(({op,f}) => { expr += ` ${op} ${f.toLocaleString('sl-SI')}`; });
      expr += ' = ?';
      hintEl.textContent = `Namig (0‚Äì2 decimalki, brez zaokro≈æevanja):\n` + lines.join('\n') + `\n` + expr;
    } else {
      const fromP = extractPrefix(fromUnit), toP = extractPrefix(toUnit);
      const baseU = extractBase(fromUnit);
      const expFrom = PREFIX_EXP[fromP];
      const expTo = PREFIX_EXP[toP];
      const f1_base = Math.pow(10, expFrom);   // do base (dim=1)
      const f2_base_to = Math.pow(10, -expTo); // base -> target (dim=1)
      const f1 = Math.pow(f1_base, dim);
      const f2 = Math.pow(f2_base_to, dim);
      const base1 = displayUnit('', baseU, 1);
      const titleBase = displayUnit('', baseU, dim);
      const titleFrom = displayUnit(fromP, baseU, dim);
      const titleTo = displayUnit(toP, baseU, dim);
      let line1, line2;
      if(dim===1){
        line1 = `1 ${titleFrom} = ${f1.toLocaleString('sl-SI')} ${titleBase}`;
        line2 = `1 ${titleBase} = ${f2.toLocaleString('sl-SI')} ${titleTo}`;
      } else {
        // power showoff ‚Äì kvadriraj/kubiraj faktorje pravilno, ne blefirat
        const powSym = dim===2?'¬≤':dim===3?'¬≥':('^'+dim);
        line1 = `1 ${titleFrom} = (${f1_base.toLocaleString('sl-SI')} ${base1})${powSym} = ${f1.toLocaleString('sl-SI')} ${titleBase}`;
        line2 = `1 ${titleBase} = (${f2_base_to.toLocaleString('sl-SI')} ${displayUnit(toP, baseU, 1)})${powSym} = ${f2.toLocaleString('sl-SI')} ${titleTo}`;
      }
      hintEl.textContent =
        `Namig:\n`+
        `${line1}\n${line2}\n`+
        `${fmtSI(given)} ${titleFrom} √ó ${f1.toLocaleString('sl-SI')} √ó ${f2.toLocaleString('sl-SI')} = ?`;
    }

    // SI format helper ‚Äì re≈°i znanstvene zapise in odveƒçne nule
    function fmtSI(x){
      let s = String(x);
      if(!/[eE]/.test(s)){ s=(+x).toPrecision(12); }
      if(/[eE]/.test(s)){ const [m,e]=s.split(/e/i); return m.replace('.',',')+'e'+e; }
      if(s.includes('.')) s=s.replace(/(\.\d*?[1-9])0+$/,'$1').replace(/\.0+$/,'');
      return s.replace('.',',');
    }

    function lock(){task.dataset.locked='true'; input.disabled=true; checkBtn.disabled=true;}

    // checker ‚Äì 0‚Äì2 dec policy + ‚ÄúPravilno!‚Äù flex
    function check(){
      if(task.dataset.locked==='true') return;
      const raw = input.value;
      const user = parseNum(raw);
      if(!Number.isFinite(user)){ resultEl.innerHTML=`<span class="bad">Vnesi ≈°tevilo.</span>`; return; }
      state.total+=1;
      if(isTime){
        // ƒçe pretirava≈° z decimalkami ‚Üí nope
        const decs = (raw.includes(',')||raw.includes('.')) ? (raw.replace(',', '.').split('.')[1]||'').length : 0;
        if(decs > 2){
          resultEl.innerHTML=`<span class="bad">Najveƒç 2 decimalki.</span>`;
          updateKPI(); return;
        }
        const target = Math.round(result*100)/100; // target je ≈æe skuhan
        if(eqTol(user, target)){
          const toLabel = labelTimeUnit(user, toUnit, 'result');
          state.correct+=1;
          resultEl.innerHTML=`<b>${fmtUpTo2(user)} ${toLabel}</b> ‚Äî <span class="ok">Pravilno!</span>`;
          lock();
        } else {
          resultEl.innerHTML=`${fmtUpTo2(given)} ‚â† ${fmtUpTo2(user)} <span class="bad">Ni prav.</span>`;
        }
      } else {
        const correct = eqTol(user, result);
        if(correct){
          state.correct+=1;
          resultEl.innerHTML=`<b>${fmtSI(user)}</b> ‚Äî <span class="ok">Pravilno!</span>`;
          lock();
        } else {
          resultEl.innerHTML=`${fmtSI(given)} ‚â† ${fmtSI(user)} <span class="bad">Poskusi ponovno.</span>`;
        }
      }
      updateKPI();
    }

    // UX: Enter = check; ostalo so toggle knofi
    input.addEventListener('keydown',e=>{ if(e.key==='Enter'){ e.preventDefault(); check(); }});
    checkBtn.addEventListener('click',check);
    hintBtn.addEventListener('click',()=>{ hintEl.style.display = hintEl.style.display==='none' ? '' : 'none'; });
    solBtn.addEventListener('click',()=>{ solEl.style.display = solEl.style.display==='none' ? '' : 'none'; });

    tasksEl.appendChild(task);
    return task;
  }

  // spawn 5 taskov ‚Äì instant action
  function makeFive(){
    state.correct=0; state.total=0; updateKPI();
    tasksEl.innerHTML='';
    const cat=$('#cat').value, level=$('#level').value, smer=$('#smer').value;
    for(let i=0;i<5;i++){ buildTask(i,cat,level,smer); }
    const first=tasksEl.querySelector('input.answer'); if(first) first.focus();
  }

  // knofi ‚Äì tisk + nova runda
  $('#make5').addEventListener('click',makeFive);
  $('#printBtn').addEventListener('click',()=>window.print());

  // init ‚Äì ni loading screena, gas
  makeFive();
})();
</script>
</body>
</html>
